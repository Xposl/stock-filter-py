# InvestNote-py 当前任务

## 任务状态
- **当前阶段**: **核心引擎重构与新功能开发阶段**
- **更新时间**: (今天日期)
- **总体优先级**: **围绕新闻驱动的AI机会发现功能进行**

## 🚀 新增核心功能任务 (高优先级)

### 1. 新闻聚合与预处理模块
**状态**: 待开始
**预计周期**: 3-4周
**负责人**: 开发团队
**依赖**: 无

**详细任务清单**:
- [ ] **新闻源管理系统**
    - [ ] 设计并实现新闻源配置的数据模型 (URL, API Key, 类型, 更新频率等)
    - [ ] 实现新闻源的CRUD API接口
    - [ ] 用户界面进行新闻源配置 (如果前端支持)
- [ ] **多源新闻获取引擎**
    - [ ] 实现RSS源新闻获取逻辑
    - [ ] 集成至少1-2个全球新闻API (如NewsAPI)
    - [ ] 实现健壮的定时抓取与更新机制 (Celery Worker)
    - [ ] 错误处理与重试机制 (网络问题、API限制)
- [ ] **新闻内容预处理**
    - [ ] 实现新闻HTML内容清洗与正文提取
    - [ ] 新闻去重算法设计与实现
    - [ ] 基础NLP处理: 分词, 实体识别 (公司, 地点, 人物), 关键词提取
    - [ ] 结构化新闻数据存储 (NewsArticle模型)

### 2. AI多Agent分析引擎基础框架
**状态**: 待开始
**预计周期**: 4-6周
**负责人**: 开发团队
**依赖**: 新闻聚合模块基本完成, LLM API接入

**详细任务清单**:
- [ ] **Agent基础类与接口定义**
    - [ ] 定义Agent的输入 (结构化新闻数据) 和输出 (分析洞察, 关联实体等)
    - [ ] 设计Agent的生命周期和执行流程 (Template Method模式)
- [ ] **LLM集成模块**
    - [ ] 封装对GPT等大语言模型API的调用
    - [ ] Prompt模板管理与动态生成
    - [ ] Token使用统计与成本控制考虑
- [ ] **首个分析Agent实现 (例如：核心事件提炼Agent)**
    - [ ] Agent逻辑：从新闻中提炼核心事件、判断事件重要性、识别主要影响对象。
    - [ ] 调用LLM进行分析。
    - [ ] 结构化存储Agent分析结果 (AgentAnalysisResult模型)。
- [ ] **Agent编排初步逻辑**
    - [ ] 实现单条新闻触发单个或固定顺序的Agent进行分析。
    - [ ] 异步执行Agent分析任务 (Celery Worker)。
- [ ] **向量数据库集成与RAG初步**
    - [ ] 选择并集成一个向量数据库 (如ChromaDB, FAISS本地版)。
    - [ ] 将新闻文本或Agent分析结果进行向量化并存储。
    - [ ] 实现简单的基于向量相似度的内容检索，为RAG做准备。

### 3. 投资主题与全球股票关联模块 (初步)
**状态**: 待开始
**预计周期**: 3-4周
**负责人**: 开发团队
**依赖**: AI Agent分析框架基本可用, 全球股票基础数据

**详细任务清单**:
- [ ] **全球股票基础数据库构建**
    - [ ] 整合现有市场数据API (AKShare, Futu API等) 获取全球主要市场股票列表及基本信息。
    - [ ] 设计并实现相关数据模型。
- [ ] **影响链初步分析逻辑**
    - [ ] 根据Agent分析出的实体和事件，初步建立新闻到行业/主题的关联。
    - [ ] 将识别出的行业/主题与全球股票池进行匹配。
- [ ] **关联结果存储** (StockNewsCorrelation, InvestmentTheme模型)

### 4. 量化指标与资金流分析模块 (基础)
**状态**: 待开始
**预计周期**: 2-3周
**负责人**: 开发团队
**依赖**: 全球股票基础数据

**详细任务清单**:
- [ ] **基础量化指标计算**
    - [ ] 实现成交量异动、价格突破等基础指标的计算。
    - [ ] 集成TA-Lib或类似库。
- [ ] **资金流指标初步**
    - [ ] 研究并实现1-2个简单的资金流向判断指标。
- [ ] **指标数据存储** (FundingFlowMetrics模型)

### 5. 机会推送与API (原型)
**状态**: 待开始
**预计周期**: 1-2周
**负责人**: 开发团队
**依赖**: 上述模块均有初步产出

**详细任务清单**:
- [ ] 设计API接口，用于展示分析出的潜在机会 (新闻摘要, AI分析点, 关联股票, 初步资金指标)。
- [ ] 实现简单的机会推送逻辑 (如邮件或简单的站内通知)。

---

## 现有任务调整与优先级变更

### 原高优先级任务 (重新评估)

#### 原1. 完善股票数据API
**新状态**: **部分纳入"全球股票基础数据库构建"和"量化指标计算"，优先级调整为中。**
**调整说明**: 重点转向支持新闻驱动的全球机会发现，而非全面的个股数据服务。

#### 原2. 用户认证和权限管理
**新状态**: **保持高优先级，但可与核心功能并行。**
**调整说明**: 用户系统依然重要，但核心是先把机会发现的流程跑通。

#### 原3. 技术指标计算优化
**新状态**: **已包含在"量化指标与资金流分析模块 (基础)"，优先级根据新模块调整。**

### 原中优先级任务 (重新评估)

#### 原4. 投资笔记系统开发
**新状态**: **优先级降低为低。**
**调整说明**: 与当前核心战略方向（新闻驱动机会发现）关联度较低，可后续考虑。

#### 原5. 错误处理和日志记录完善
**新状态**: **保持中高优先级，需贯穿于所有新模块开发中。**

---
## 技术债务 (保持关注)
- 测试覆盖率提升 (需为新模块编写测试)
- API文档完善 (需为新API编写文档)
- 性能监控体系 (尤其针对NLP, Agent, DB查询)

## 阻塞问题 (潜在)
- **外部API依赖**: 新闻API、LLM API的稳定性、费用、限制。
- **数据质量**: 新闻数据和市场数据的质量直接影响分析结果。
- **AI分析效果**: LLM和Agent分析的准确性、深度需要持续调优。
- **算法复杂度**: 影响链分析、资金埋伏识别等算法可能较复杂。

## 未来几周重点 (围绕新核心功能)
1.  **搭建新闻聚合与预处理流水线。**
2.  **实现AI Agent基础框架并集成LLM。**
3.  **构建全球股票基础信息库。**
4.  **并行推进用户认证模块。**

## 成功标准 (新阶段)
1.  **功能原型**：能够完整跑通"新闻获取 -> AI初步分析 -> 关联股票展示（含基础资金指标）"的流程。
2.  **AI能力验证**：Agent能够从新闻中提取有效信息并做出初步的、有价值的判断。
3.  **数据覆盖**：至少能聚合来自若干主流渠道的全球新闻，并覆盖主要股票市场。 
# InvestNote-py æŠ€æœ¯ä¸Šä¸‹æ–‡

## æ ¸å¿ƒæŠ€æœ¯æ ˆ (å½“å‰å®ç°)

### ğŸ—ï¸ Webæ¡†æ¶ä¸æœåŠ¡
- **FastAPI**: ç°ä»£ã€é«˜æ€§èƒ½çš„Python Webæ¡†æ¶ï¼ŒAPIæœåŠ¡æ ¸å¿ƒ
- **Uvicorn**: ASGIæœåŠ¡å™¨ï¼Œæ”¯æŒé«˜å¹¶å‘å¼‚æ­¥å¤„ç†
- **Pydantic**: æ•°æ®éªŒè¯å’Œç±»å‹å®‰å…¨ï¼Œæ‰€æœ‰æ¨¡å‹åŸºäºBaseModel
- **aiohttp**: å¼‚æ­¥HTTPå®¢æˆ·ç«¯ï¼Œå¤–éƒ¨APIè°ƒç”¨

### ğŸ¤– AIä¸æœºå™¨å­¦ä¹ å¼•æ“ (å·²é›†æˆ)
- **PocketFlow**: 100è¡ŒLLMå·¥ä½œæµæ¡†æ¶ï¼ŒAIåˆ†ææµæ°´çº¿æ ¸å¿ƒ
  - GitHub: https://github.com/The-Pocket/PocketFlow
  - è½»é‡çº§è®¾è®¡ï¼Œä¸“ä¸ºå¤æ‚AIå·¥ä½œæµæ„å»º
- **åƒé—®LLM**: é˜¿é‡Œäº‘å¤§è¯­è¨€æ¨¡å‹ï¼Œä¸»è¦AIåˆ†æå¼•æ“
- **ç¡…åŸºæµåŠ¨API**: OpenAIå…¼å®¹æ¥å£ï¼Œåƒé—®çš„å¤‡ç”¨LLMæœåŠ¡
- **ChromaDB**: åµŒå…¥å¼å‘é‡æ•°æ®åº“ï¼Œè¯­ä¹‰ç›¸ä¼¼æ€§åˆ†æ
- **Sentence Transformers**: æ–‡æœ¬å‘é‡åŒ–å’Œè¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®—

### ğŸ“Š è‚¡ç¥¨æ•°æ®æºæ¶æ„ (å·²å®Œæˆ)
- **AKShare**: ä¼˜å…ˆçº§100ï¼Œä¸»è¦è‚¡ç¥¨æ•°æ®æº
  - æ”¯æŒAè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡å®Œæ•´æ•°æ®
  - å®æ—¶è¡Œæƒ…ã€å†å²æ•°æ®ã€å…¬å¸ä¿¡æ¯ã€è‚¡ç¥¨æœç´¢
- **é›ªçƒAPI**: ä¼˜å…ˆçº§50ï¼Œè¡¥å……æ•°æ®æº
  - åŸºäºé‡æ„åçš„æŠ½è±¡å±‚å®ç°
  - ç»Ÿä¸€çš„å®¢æˆ·ç«¯å·¥å‚å’Œä¼šè¯ç®¡ç†
- **æ•°æ®æä¾›è€…å·¥å‚**: ç­–ç•¥æ¨¡å¼æ™ºèƒ½é™çº§
  - é”™è¯¯è®¡æ•°å’Œå¯ç”¨æ€§ç›‘æ§
  - è‡ªåŠ¨åˆ‡æ¢å’Œæ¢å¤æœºåˆ¶

### ğŸ“° æ–°é—»èšåˆæŠ€æœ¯æ ˆ (å·²å®ç°)
- **feedparser**: RSSæºè§£æå’Œå†…å®¹æå–
- **newspaper3k**: æ–°é—»ç½‘é¡µå†…å®¹æå–å’Œå…ƒæ•°æ®è§£æ
- **beautifulsoup4**: HTMLè§£æå’Œå†…å®¹æŠ“å–
- **readability**: ç½‘é¡µå¯è¯»æ€§ä¼˜åŒ–å’Œæ ¸å¿ƒå†…å®¹æå–
- **lxml_html_clean**: HTMLå†…å®¹æ¸…ç†å’Œå®‰å…¨å¤„ç†

### ğŸ—„ï¸ æ•°æ®å­˜å‚¨å±‚
- **MySQL**: ç”Ÿäº§ç¯å¢ƒä¸»æ•°æ®åº“ï¼Œå®Œæ•´å…³ç³»å‹æ•°æ®æ”¯æŒ
- **SQLite**: å¼€å‘ç¯å¢ƒæ•°æ®åº“ï¼Œè½»é‡çº§å¿«é€Ÿå¼€å‘
- **ChromaDB**: å‘é‡æ•°æ®åº“ï¼ŒåµŒå…¥å¼éƒ¨ç½²ï¼Œæ”¯æŒè¯­ä¹‰æ£€ç´¢
- **DbAdapter**: ç»Ÿä¸€æ•°æ®åº“é€‚é…å™¨ï¼Œæ”¯æŒå¤šæ•°æ®åº“ç±»å‹è‡ªåŠ¨è½¬æ¢

### ğŸ”’ è®¤è¯ä¸å®‰å…¨ (å·²å®ç°)
- **gRPC**: å¾®æœåŠ¡é—´é€šä¿¡ï¼Œè®¤è¯æœåŠ¡é›†æˆ
- **JWT Token**: ç”¨æˆ·ä¼šè¯ç®¡ç†å’ŒAPIè®¤è¯
- **python-jose**: JWT tokenå¤„ç†å’ŒéªŒè¯
- **è®¤è¯ä¸­é—´ä»¶**: FastAPIä¸­é—´ä»¶å®ç°ç»Ÿä¸€è®¤è¯

### ğŸ§ª æµ‹è¯•ä¸è´¨é‡ä¿è¯
- **pytest**: ä¸»è¦æµ‹è¯•æ¡†æ¶
- **pytest-asyncio**: å¼‚æ­¥ä»£ç æµ‹è¯•æ”¯æŒ
- **pytest-cov**: æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡
- **ç±»å‹æ£€æŸ¥**: Pythonç±»å‹æç¤º + mypyæ”¯æŒ

### ğŸš€ éƒ¨ç½²ä¸å®¹å™¨åŒ–
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒ
- **docker-compose**: å¤šå®¹å™¨ç¼–æ’å’Œç¯å¢ƒç®¡ç†
- **è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬**: deploy.shæ”¯æŒç‰ˆæœ¬ç®¡ç†å’ŒcrontabåŒæ­¥

## é¡¹ç›®æ¶æ„è¯¦è§£ (å½“å‰çŠ¶æ€)

### ä¸‰å±‚ä¸šåŠ¡æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APIå±‚ (api/)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ticker    â”‚ â”‚    news     â”‚ â”‚      scheduler         â”‚ â”‚
â”‚  â”‚   routes    â”‚ â”‚   routes    â”‚ â”‚      routes            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Handlerå±‚ (core/handler/)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ticker    â”‚ â”‚    news     â”‚ â”‚    AI analysis         â”‚ â”‚
â”‚  â”‚  analysis   â”‚ â”‚  handler    â”‚ â”‚     handler            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Repositoryå±‚ (core/service/)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ticker    â”‚ â”‚    news     â”‚ â”‚      score             â”‚ â”‚
â”‚  â”‚ repository  â”‚ â”‚ repository  â”‚ â”‚   repository           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Modelå±‚ (core/models/)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Ticker    â”‚ â”‚ NewsArticle â”‚ â”‚    TickerScore         â”‚ â”‚
â”‚  â”‚  (Pydantic) â”‚ â”‚ (Pydantic)  â”‚ â”‚    (Pydantic)          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æä¾›è€…å±‚æ¶æ„ (å·²å®ç°)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                StockDataFactory (ç­–ç•¥å·¥å‚)                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚              â”‚    æ™ºèƒ½æ•°æ®æºé€‰æ‹©å’Œé™çº§ç­–ç•¥       â”‚            â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AKShareProvider â”‚ â”‚  XueqiuProvider  â”‚ â”‚  FutureProvider â”‚
â”‚   (ä¼˜å…ˆçº§: 100)   â”‚ â”‚   (ä¼˜å…ˆçº§: 50)   â”‚ â”‚   (é¢„ç•™æ‰©å±•)     â”‚
â”‚                  â”‚ â”‚                  â”‚ â”‚                 â”‚
â”‚ â€¢ Aè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡ â”‚ â”‚ â€¢ è¡¥å……æ•°æ®æº     â”‚ â”‚ â€¢ æœŸè´§ã€æœŸæƒ     â”‚
â”‚ â€¢ å®æ—¶è¡Œæƒ…æ•°æ®   â”‚ â”‚ â€¢ æ–°é—»æ—¶é—´çº¿     â”‚ â”‚ â€¢ è¡ç”Ÿå“æ•°æ®     â”‚
â”‚ â€¢ å†å²Kçº¿æ•°æ®    â”‚ â”‚ â€¢ ç¤¾åŒºæƒ…ç»ªæ•°æ®   â”‚ â”‚                 â”‚
â”‚ â€¢ å…¬å¸åŸºæœ¬ä¿¡æ¯   â”‚ â”‚                  â”‚ â”‚                 â”‚
â”‚ â€¢ è‚¡ç¥¨æœç´¢åŠŸèƒ½   â”‚ â”‚                  â”‚ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é›ªçƒæŠ½è±¡å±‚æ¶æ„ (å·²é‡æ„)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              XueqiuClientFactory (å®¢æˆ·ç«¯å·¥å‚)               â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚              â”‚      ç»Ÿä¸€é…ç½®å’Œä¼šè¯ç®¡ç†          â”‚            â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚XueqiuBaseClient  â”‚ â”‚XueqiuNewsClient  â”‚ â”‚XueqiuStockClientâ”‚
â”‚                  â”‚ â”‚                  â”‚ â”‚                 â”‚
â”‚ â€¢ ä¼šè¯ç®¡ç†       â”‚ â”‚ â€¢ æ–°é—»æ—¶é—´çº¿     â”‚ â”‚ â€¢ è‚¡ç¥¨è¡Œæƒ…       â”‚
â”‚ â€¢ ä»¤ç‰Œè·å–       â”‚ â”‚ â€¢ è‚¡ç¥¨æ–°é—»       â”‚ â”‚ â€¢ å…¬å¸ä¿¡æ¯       â”‚
â”‚ â€¢ HTTPè¯·æ±‚å°è£…   â”‚ â”‚ â€¢ é‡è¦æ€§è¯„åˆ†     â”‚ â”‚ â€¢ å¤šå¸‚åœºæ”¯æŒ     â”‚
â”‚ â€¢ é”™è¯¯å¤„ç†       â”‚ â”‚ â€¢ å†…å®¹è¿‡æ»¤       â”‚ â”‚ â€¢ å®æ—¶æ•°æ®       â”‚
â”‚ â€¢ é‡è¯•æœºåˆ¶       â”‚ â”‚                  â”‚ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AIåˆ†ææµæ°´çº¿ (åŸºäºPocketFlow)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ–°é—»è¾“å…¥ (RSS/API)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               è§„åˆ™é¢„ç­›é€‰å±‚ (Rule-based Filter)              â”‚
â”‚  â€¢ å…³é”®è¯è¿‡æ»¤  â€¢ æ¥æºæƒé‡  â€¢ æ—¶æ•ˆæ€§æ£€æŸ¥  â€¢ é‡å¤æ£€æµ‹         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AIæ·±åº¦åˆ†æå±‚ (PocketFlow + åƒé—®LLM)             â”‚
â”‚  â€¢ äº‹ä»¶è¯†åˆ«  â€¢ å½±å“é“¾åˆ†æ  â€¢ è¡Œä¸šå…³è”  â€¢ Tokenä¼˜åŒ–           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               æƒ…æ„Ÿè¯„ä¼°å±‚ (Sentiment Analysis)               â”‚
â”‚  â€¢ æƒ…æ„Ÿæ‰“åˆ†  â€¢ å¸‚åœºå½±å“åº¦  â€¢ é£é™©è¯„ä¼°  â€¢ ç½®ä¿¡åº¦è®¡ç®—         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æŠ•èµ„å»ºè®®å±‚ (Investment Recommendation)          â”‚
â”‚  â€¢ è‚¡ç¥¨å…³è”  â€¢ çŸ­æœŸè¯„ä¼°  â€¢ é£é™©ç­‰çº§  â€¢ æ“ä½œå»ºè®®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å‘é‡ç›¸ä¼¼æ€§å±‚ (ChromaDB Semantic Search)          â”‚
â”‚  â€¢ è¯­ä¹‰ç›¸ä¼¼æ€§  â€¢ å†å²å¯¹æ¯”  â€¢ äº‹ä»¶èšç±»  â€¢ è¶‹åŠ¿å‘ç°           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®åº“è®¾è®¡ (å½“å‰å®ç°)

### æ ¸å¿ƒè¡¨ç»“æ„
```sql
-- è‚¡ç¥¨åŸºç¡€ä¿¡æ¯ (æ”¯æŒå¤šå¸‚åœº)
ticker: id, code, name, group_id, market, status, create_time

-- è‚¡ç¥¨è¯„åˆ†æ•°æ® (æ”¯æŒå¤šç®—æ³•)
ticker_score: id, ticker_id, time_key, ma_buy, ma_sell, ma_score, 
              in_buy, in_sell, in_score, strategy_buy, strategy_sell, 
              strategy_score, score, history(JSON)

-- æ–°é—»æºé…ç½®
news_sources: id, name, source_type, url, status, weight, config(JSON)

-- æ–°é—»æ–‡ç«  (åŒ…å«AIåˆ†æ)
news_articles: id, title, content, url, source_id, published_at,
               ai_analysis(JSON), sentiment_score, stock_relations(JSON)

-- æŠ€æœ¯æŒ‡æ ‡æ•°æ®
ticker_indicator: id, ticker_id, time_key, indicator_key, value, history(JSON)

-- æŠ•èµ„ç­–ç•¥æ•°æ®
ticker_strategy: id, ticker_id, time_key, strategy_key, position, 
                 signal_strength, strategy_params(JSON)
```

### Pydanticæ¨¡å‹ç‰¹è‰²
- **ç»Ÿä¸€BaseModel**: æ‰€æœ‰æ¨¡å‹ç»§æ‰¿Pydantic BaseModel
- **ä¸‰å±‚ç»“æ„**: Base â†’ Create â†’ Update â†’ Full
- **ç±»å‹å®‰å…¨**: å®Œæ•´type hintså’Œè¿è¡Œæ—¶éªŒè¯
- **åºåˆ—åŒ–æ”¯æŒ**: to_dict()å’Œfrom_dict()è¾…åŠ©å‡½æ•°
- **JSONå­—æ®µ**: historyã€configç­‰å¤æ‚æ•°æ®ç»“æ„æ”¯æŒ

## æ ¸å¿ƒæŠ€æœ¯å®ç°æ¨¡å¼

### 1. æ•°æ®æä¾›è€…æ¨¡å¼ (å·²å®Œæˆ)
```python
# ç»Ÿä¸€è‚¡ç¥¨æ•°æ®è®¿é—®
from core.data_providers.stock_data_factory import get_stock_quote

# è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ•°æ®æºå¹¶æ”¯æŒé™çº§
response = get_stock_quote("600000", market=StockMarket.A_SHARE)
if response.success:
    stock_data = response.data
```

### 2. é›ªçƒæŠ½è±¡å±‚æ¨¡å¼ (å·²é‡æ„)
```python
# ç»Ÿä¸€é›ªçƒå®¢æˆ·ç«¯è®¿é—®
from core.utils.xueqiu.xueqiu_client_factory import create_stock_client

async with create_stock_client() as client:
    # ç»Ÿä¸€çš„å¼‚æ­¥æ¥å£
    quote = await client.get_stock_quote_async("SH600000")
    company = await client.get_company_info_async("SH600000")
```

### 3. PocketFlow AIå·¥ä½œæµ (å·²é›†æˆ)
```python
# åŸºäºPocketFlowçš„æ–°é—»åˆ†ææµç¨‹
from core.ai_agents.news_analysis_flow import NewsAnalysisFlow

flow = NewsAnalysisFlow()
result = await flow.run({
    "news_content": article.content,
    "news_title": article.title,
    "source_weight": source.weight
})

# è·å–ç»“æ„åŒ–åˆ†æç»“æœ
analysis = result.get("analysis")
sentiment = result.get("sentiment_score") 
recommendations = result.get("investment_advice")
```

### 4. è¯„åˆ†ç³»ç»Ÿæ ‡å‡†åŒ– (å·²å®Œæˆ)
```python
# ç»Ÿä¸€çš„List[TickerScore]è¿”å›ç±»å‹
from core.score.trend_score import TrendScore

trend_scorer = TrendScore()
scores = trend_scorer.calculate(ticker, kl_data, strategy_data)
# scores: List[TickerScore] - æ ‡å‡†åŒ–è¿”å›ç±»å‹

# è‡ªåŠ¨ç±»å‹è½¬æ¢æ”¯æŒå‘åå…¼å®¹
from core.data_source_helper import DataSourceHelper
helper = DataSourceHelper()
dict_scores = helper.convert_ticker_scores_to_dict(scores)
```

## å¼‚æ­¥ç¼–ç¨‹æ¶æ„

### å¼‚æ­¥ä¼˜å…ˆè®¾è®¡
- **FastAPI**: å…¨å¼‚æ­¥APIæœåŠ¡å™¨
- **aiohttp**: å¼‚æ­¥HTTPå®¢æˆ·ç«¯
- **æ•°æ®åº“æ“ä½œ**: æ”¯æŒå¼‚æ­¥æ•°æ®åº“æ“ä½œ
- **ä»»åŠ¡è°ƒåº¦**: å¼‚æ­¥åå°ä»»åŠ¡å¤„ç†
- **AIåˆ†æ**: å¼‚æ­¥LLMè°ƒç”¨å’Œå‘é‡è®¡ç®—

### å¹¶å‘å¤„ç†æ¨¡å¼
```python
# å¹¶å‘æ•°æ®è·å–
import asyncio

async def fetch_multiple_sources(ticker_codes):
    tasks = [
        akshare_provider.get_stock_quote_async(code) 
        for code in ticker_codes
    ]
    results = await asyncio.gather(*tasks, return_exceptions=True)
    return [r for r in results if not isinstance(r, Exception)]
```

## éƒ¨ç½²æ¶æ„

### Dockerå®¹å™¨åŒ–
```yaml
# docker-compose.yml
services:
  investnote-api:
    build: .
    ports: ["8000:8000"]
    environment:
      - DB_TYPE=mysql
      - LLM_PROVIDER=qianwen
    volumes:
      - ./data:/app/data
      
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: investnote
      
  redis:
    image: redis:7.0
    ports: ["6379:6379"]
```

### è‡ªåŠ¨åŒ–éƒ¨ç½²
```bash
# deploy.sh - æ”¯æŒç‰ˆæœ¬ç®¡ç†å’ŒcrontabåŒæ­¥
./deploy.sh v1.2.3  # æŒ‡å®šç‰ˆæœ¬éƒ¨ç½²
# è‡ªåŠ¨å¤‡ä»½æ—§crontabï¼Œéƒ¨ç½²æ–°crontabï¼Œé‡å¯å®¹å™¨
```

## ç›‘æ§ä¸è¿ç»´

### å¥åº·æ£€æŸ¥
- **APIå¥åº·æ£€æŸ¥**: `/health` ç«¯ç‚¹
- **æ•°æ®åº“è¿æ¥æ£€æŸ¥**: å®æ—¶è¿æ¥çŠ¶æ€ç›‘æ§
- **å¤–éƒ¨æœåŠ¡æ£€æŸ¥**: æ•°æ®æºå¯ç”¨æ€§ç›‘æ§
- **AIæœåŠ¡æ£€æŸ¥**: LLMæœåŠ¡å“åº”çŠ¶æ€

### æ€§èƒ½æŒ‡æ ‡
- **å“åº”æ—¶é—´**: APIå“åº”æ—¶é—´ç›‘æ§
- **æ•°æ®æºæˆåŠŸç‡**: å„æ•°æ®æºæˆåŠŸç‡ç»Ÿè®¡
- **AIåˆ†æè€—æ—¶**: LLMè°ƒç”¨å»¶è¿Ÿè·Ÿè¸ª
- **å¹¶å‘å¤„ç†èƒ½åŠ›**: å¼‚æ­¥ä»»åŠ¡å¤„ç†æ€§èƒ½

## æ‰©å±•æ€§è®¾è®¡

### æ¨¡å—åŒ–æ‰©å±•
- **æ–°æ•°æ®æº**: å®ç°DataProvideræ¥å£å³å¯é›†æˆ
- **æ–°AIæ¨¡å‹**: åŸºäºPocketFlowæ·»åŠ æ–°çš„å·¥ä½œæµ
- **æ–°è¯„åˆ†ç®—æ³•**: ç»§æ‰¿BaseScoreå®ç°æ–°ç®—æ³•
- **æ–°å¸‚åœºæ”¯æŒ**: æ‰©å±•StockMarketæšä¸¾å’Œæ•°æ®æ˜ å°„

### å‘åå…¼å®¹
- **APIç‰ˆæœ¬ç®¡ç†**: è·¯ç”±ç‰ˆæœ¬æ§åˆ¶
- **æ¨¡å‹å…¼å®¹**: Pydanticæ¨¡å‹å‘å‰å…¼å®¹
- **æ•°æ®åº“è¿ç§»**: SQLAlchemyè¿ç§»è„šæœ¬æ”¯æŒ
- **é…ç½®å…¼å®¹**: ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶å‘å‰å…¼å®¹ 